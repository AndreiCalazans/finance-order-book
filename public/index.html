<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fake Trading Pair Order Book with Inferno.js</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #f4f4f4;
        }
        #orderBook {
            width: 600px;
            border-collapse: collapse;
        }
        #orderBook th, #orderBook td {
            padding: 8px;
            border: 1px solid #ddd;
        }
        #orderBook th {
            background-color: #f2f2f2;
        }
        .buy {
            color: green;
        }
        .sell {
            color: red;
        }
    </style>
    <!-- Include Inferno.js and InfernoDOM from CDN -->
    <script src="https://cdn.jsdelivr.net/npm/inferno@7.4.11/dist/inferno.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/inferno@7.4.11/dist/inferno-dom.min.js"></script>
    <script src="https://unpkg.com/inferno-create-element@7.4.11/dist/inferno-create-element.js"></script>
    <script src="https://unpkg.com/inferno-create-element@7.4.11/dist/inferno-create-element.min.js"></script>
</head>
<body>
    <div id="root"></div>

    <script>
        const { createElement, Component, render } = Inferno;

        class OrderBook extends Component {
            constructor(props) {
                super(props);
                this.state = { orders: [] };
            }

            componentDidMount() {
                const eventSource = new EventSource('/order-book-stream');
                eventSource.onmessage = (event) => {
                    const data = JSON.parse(event.data);
                    this.setState({ orders: data });
                };

                eventSource.onerror = (err) => {
                    console.error('EventSource failed:', err);
                    eventSource.close();
                };

                this.eventSource = eventSource;
            }

            componentWillUnmount() {
                if (this.eventSource) {
                    this.eventSource.close();
                }
            }

            render() {
                return createElement(
                    'table',
                    { id: 'orderBook' },
                    createElement(
                        'thead',
                        null,
                        createElement(
                            'tr',
                            null,
                            createElement('th', null, 'Price'),
                            createElement('th', null, 'Amount'),
                            createElement('th', null, 'Side')
                        )
                    ),
                    createElement(
                        'tbody',
                        null,
                        this.state.orders.map((order, index) =>
                            createElement(
                                'tr',
                                { key: index },
                                createElement(
                                    'td',
                                    null,
                                    new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }).format(order.price)
                                ),
                                createElement(
                                    'td',
                                    null,
                                    new Intl.NumberFormat('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(order.amount) + ' units'
                                ),
                                createElement(
                                    'td',
                                    { className: order.side },
                                    order.side
                                )
                            )
                        )
                    )
                );
            }
        }

        render(createElement(OrderBook), document.getElementById('root'));
    </script>
</body>
</html>

